class e{x=-1;y=-1;constructor(e,t,s){this.game=e,this.image=t,this.width=t.width,this.height=t.height,this.speed=s}update(e){this.x<=-this.width?this.x=0:this.x-=e*this.speed}draw(){this.game.ctx.drawImage(this.image,this.x,this.y),this.game.ctx.drawImage(this.image,this.x+this.width,this.y)}}class t{layers=[];constructor(t){this.game=t,this.layers=[new e(t,document.getElementById("bg"),0),new e(t,document.getElementById("hills"),.5)]}update(e){this.layers.forEach((t=>t.update(e)))}draw(){this.layers.forEach((e=>e.draw()))}}class s{keys={right:{key:"d",pressed:!1},left:{key:"a",pressed:!1},up:{key:"w",pressed:!1}};constructor(){this.addDesktopControl()}addDesktopControl(){window.addEventListener("keydown",(e=>{for(const t in this.keys)e.key===this.keys[t].key&&(this.keys[t].pressed=!0)})),window.addEventListener("keyup",(e=>{for(const t in this.keys)e.key===this.keys[t].key&&(this.keys[t].pressed=!1)}))}}class i{updateSprite(){this.frameX<this.maxFrame?this.frameX++:this.frameX=0}draw(){this.game.ctx.drawImage(this.image,this.frameX*this.width,this.frameY*this.height,this.width,this.height,this.x,this.y,this.width,this.height)}}class h extends i{x=0;y=0;image=document.getElementById("idleRight");width=0;height=200;frameX=0;frameY=0;speedX=0;speedY=0;gravity=.8;maxFrame=0;constructor(e,t){super(),this.game=e,this.turnRight(),this.lives=t}update(){this.x+=this.speedX,this.y+=this.speedY,this.onGravity(),this.updateSprite()}onGravity(){this.y+this.height+this.speedY<=this.game.canvas.height&&(this.speedY+=this.gravity)}turnRight(){this.image=document.getElementById("idleRight"),this.maxFrame=59,this.width=88.5}turnLeft(){this.image=document.getElementById("idleLeft"),this.maxFrame=59,this.width=88.5}setWalkRightSkin(){this.image=document.getElementById("walkRight"),this.width=170.5,this.maxFrame=29}setWalkLeftSkin(){this.image=document.getElementById("walkLeft"),this.width=170.5,this.maxFrame=29}stop(){this.turnRight(),this.speedX=0}jump(){0===this.speedY&&(this.speedY=-22)}}class a extends i{gravity=.8;frameX=0;frameY=0;speedY=0;speedX=0;markDeleted=!1;enemyTimer=0;enemyInterval=2e3;constructor(e){super(),this.game=e}update(e){this.x+=this.speedX-this.speed,this.y+=this.speedY,this.y+this.height+this.speedY<=this.game.canvas.height&&(this.speedY+=this.gravity),this.updateSprite(),this.enemyTimer>this.enemyInterval?(this.attack(),this.enemyTimer=0):this.enemyTimer+=e}kill(){this.markDeleted=!0}attack(){}}class m extends a{image=document.getElementById("ghost");width=130.5;height=104.5;frameX=0;frameY=0;speedX=0;speedY=0;maxFrame=5;lives=1;speed=4;gravity=0;constructor(e,t){super(e),this.game=e,this.x=t.x,this.y=t.y}attack(){this.speed=Math.floor(4*Math.random()+6)}}class n extends a{image=document.getElementById("spider");width=155;height=88;frameX=0;frameY=0;speedX=0;speedY=0;maxFrame=5;lives=1;speed=1.5;constructor(e,t){super(e),this.game=e,this.x=t.x,this.y=t.y}attack(){this.speedY=-Math.floor(11*Math.random()+15)}}class r extends a{image=document.getElementById("worm");width=114.5;height=85.5;frameX=0;frameY=0;speedX=0;speedY=0;maxFrame=5;lives=1;speed=1;constructor(e,t){super(e),this.game=e,this.x=t.x,this.y=t.y}}class l{width=500;height=100;speedX=0;speedY=0;constructor(e,t,s){this.game=e,this.image=t,this.x=s.x,this.y=s.y}update(){this.x+=this.speedX,this.y+=this.speedY}draw(){this.game.ctx.drawImage(this.image,this.x,this.y,this.width,this.height)}}class d extends i{image=document.getElementById("door");frameX=0;frameY=0;maxFrame=5;opened=!1;touched=!1;height=224;width=184;speedX=0;constructor(e,t){super(),this.game=e,this.x=t.x,this.y=t.y}update(){this.x+=this.speedX,this.touched&&this.frameX<this.maxFrame-1?this.frameX++:this.touched?(this.frameX=this.maxFrame-1,setTimeout((()=>this.opened=!0),500)):this.frameX=0}}class o{constructor(e){this.game=e,setTimeout((()=>this.message=null),1e3)}draw(){this.platforms.forEach((e=>e.draw())),this.portal.draw(),this.enemies.forEach((e=>e.draw())),this.booms.forEach((e=>e.draw()))}update(e){this.portal.update(),this.enemies.forEach((t=>t.update(e))),this.booms.forEach((e=>e.update())),this.enemies=this.enemies.filter((e=>!e.markDeleted&&(!(e.y>this.game.canvas.height)&&!(e.x+500<0)))),this.booms=this.booms.filter((e=>!e.markDeleted));for(const e in this.enemiesToAdd){const t=this.enemiesToAdd[e];this.game.scrollOffset>Number(e)&&t&&t.length&&(this.enemies.push(...t),delete this.enemiesToAdd[e])}}}const g=document.getElementById("platform");const y=document.getElementById("platform");const p=[class extends o{platforms=[];enemies=[];booms=[];endX=5900;message="Level 1";enemiesToAdd={1200:[new r(this.game,{x:1e3,y:300}),new r(this.game,{x:1200,y:300}),new r(this.game,{x:1350,y:300}),new r(this.game,{x:1500,y:300})],1600:[new r(this.game,{x:1600,y:100}),new m(this.game,{x:2e3,y:50}),new n(this.game,{x:1200,y:50})],3300:[new r(this.game,{x:900,y:0}),new r(this.game,{x:1100,y:0}),new m(this.game,{x:2e3,y:50})],4500:[new r(this.game,{x:900,y:0}),new n(this.game,{x:1e3,y:50}),new n(this.game,{x:1100,y:50})]};constructor(e){super(e),this.game=e,this.portal=new d(this.game,{x:5500,y:276}),this.platforms=[new l(this.game,g,{x:300,y:200}),new l(this.game,g,{x:-110,y:500}),new l(this.game,g,{x:389,y:500}),new l(this.game,g,{x:888,y:500}),new l(this.game,g,{x:1900,y:500}),new l(this.game,g,{x:2399,y:500}),new l(this.game,g,{x:2898,y:500}),new l(this.game,g,{x:4e3,y:400}),new l(this.game,g,{x:5e3,y:500}),new l(this.game,g,{x:5499,y:500}),new l(this.game,g,{x:5998,y:500}),new l(this.game,g,{x:6497,y:500})],this.enemies=[new r(this.game,{x:400,y:300}),new r(this.game,{x:550,y:300}),new r(this.game,{x:700,y:300}),new m(this.game,{x:1300,y:100}),new n(this.game,{x:1300,y:100})]}},class extends o{platforms=[];enemies=[];booms=[];endX=5900;message="Level 2";enemiesToAdd={800:[new n(this.game,{x:1200,y:100})],1200:[new r(this.game,{x:1200,y:300}),new r(this.game,{x:1300,y:300}),new r(this.game,{x:1400,y:300})],1400:[new m(this.game,{x:2e3,y:100})],1600:[new r(this.game,{x:1600,y:100})],3300:[new m(this.game,{x:1600,y:100}),new r(this.game,{x:900,y:0}),new r(this.game,{x:1100,y:0})],4500:[new r(this.game,{x:900,y:0}),new m(this.game,{x:2e3,y:50}),new n(this.game,{x:800,y:100})],5e3:[new r(this.game,{x:900,y:0}),new r(this.game,{x:1100,y:0}),new r(this.game,{x:1200,y:0}),new m(this.game,{x:2e3,y:150}),new n(this.game,{x:1200,y:100}),new n(this.game,{x:1400,y:100})]};constructor(e){super(e),this.game=e,this.portal=new d(this.game,{x:6500,y:276}),this.platforms=[new l(this.game,y,{x:2500,y:200}),new l(this.game,y,{x:3e3,y:100}),new l(this.game,y,{x:3500,y:50}),new l(this.game,y,{x:-110,y:500}),new l(this.game,y,{x:389,y:500}),new l(this.game,y,{x:1500,y:500}),new l(this.game,y,{x:2399,y:500}),new l(this.game,y,{x:2898,y:500}),new l(this.game,y,{x:4e3,y:400}),new l(this.game,y,{x:5e3,y:500}),new l(this.game,y,{x:5499,y:500}),new l(this.game,y,{x:5998,y:500}),new l(this.game,y,{x:6497,y:500})],this.enemies=[new r(this.game,{x:400,y:300}),new r(this.game,{x:500,y:300}),new r(this.game,{x:600,y:300})]}}];class c{heartImg=document.getElementById("heart");constructor(e){this.game=e}draw(){const e=this.game.ctx;for(let t=1;t<=this.game.player.lives;t++)e.drawImage(this.heartImg,20*t+20*t,20,20,20);e.textAlign="center",e.fillStyle="white",e.font="58px Tahoma";const t=this.game.canvas.width/2,s=this.game.canvas.height/2;this.game.gameOver&&this.game.ctx.fillText("Game Over",t,s),this.game.win&&this.game.ctx.fillText("You Win",t,s),this.game.level.message&&this.game.ctx.fillText(this.game.level.message,t,s)}}class x extends i{frameX=0;frameY=0;maxFrame=4;width=100;height=90;image=document.getElementById("boom");x=0;markDeleted=!1;speedX=0;constructor(e,t){super(),this.game=e,this.x=t.x,this.y=t.y}update(){this.x+=this.speedX,this.frameX<this.maxFrame?this.frameX++:this.markDeleted=!0}}const w=new class{canvas=document.getElementById("canvas");ctx=this.canvas.getContext("2d");player=new h(this,3);control=new s;background=new t(this);ui=new c(this);levelIndex=0;speed=10;scrollOffset=0;gameOver=!1;win=!1;constructor(){this.canvas.width=1024,this.canvas.height=576;const e=p[this.levelIndex];this.level=new e(this)}update(e){if(this.ctx.fillStyle="#999",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.player.update(),this.level.update(e),this.level.platforms.forEach((e=>{e.update(),this.platformCollistions(this.player,e)&&(this.player.speedY=0),this.level.enemies.forEach((t=>{this.platformCollistions(t,e)&&(t.speedY=0)}))})),this.gameOver||this.win)this.stopMoving();else{if(this.control.keys.right.pressed&&this.control.keys.left.pressed)this.player.stop(),this.stopMoving();else if(this.control.keys.right.pressed)this.player.setWalkRightSkin(),this.player.x<500?this.player.speedX=this.speed:(this.player.speedX=0,this.scrollOffset<this.level.endX?(this.scrollOffset+=this.speed,this.background.update(this.speed),this.level.portal.speedX=-this.speed,this.level.platforms.forEach((e=>e.speedX=-this.speed)),this.level.enemies.forEach((e=>e.speedX=-this.speed+e.speed))):(this.scrollOffset=this.level.endX,this.stopMoving()));else if(this.control.keys.left.pressed)if(this.player.setWalkLeftSkin(),this.player.x>100)this.player.speedX=-this.speed;else{this.player.speedX=0;const e=-100;this.scrollOffset>e?(this.scrollOffset-=this.speed,this.level.portal.speedX=this.speed,this.level.platforms.forEach((e=>e.speedX=this.speed)),this.level.enemies.forEach((e=>e.speedX=this.speed-e.speed)),this.background.update(-this.speed)):(this.scrollOffset=e,this.stopMoving())}else this.player.stop(),this.stopMoving();this.control.keys.up.pressed&&this.player.jump(),this.level.enemies.forEach((e=>{e.markDeleted||this.checkCollistions(e,this.player)&&(this.enemyKillCollistions(this.player,e)?(e.kill(),this.level.booms.push(new x(this,{x:e.x,y:e.y+e.height/2})),this.player.speedY=-10):this.loose())})),this.checkCollistions(this.level.portal,this.player)&&(this.level.portal.touched=!0),this.level.portal.opened&&(p[this.levelIndex+1]?(this.levelIndex++,this.init()):this.win=!0),this.player.y>this.canvas.height&&this.loose()}}draw(){this.background.draw(),this.level.draw(),this.player.draw(),this.ui.draw()}loose(){this.player.lives--,this.player.lives>0?this.init():this.gameOver=!0}init(){this.scrollOffset=0,this.player=new h(this,this.player.lives),this.background=new t(this);const e=p[this.levelIndex];this.level=new e(this)}stopMoving(){this.level.platforms.forEach((e=>e.speedX=0)),this.level.enemies.forEach((e=>e.speedX=0)),this.level.portal.speedX=0}checkCollistions(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}platformCollistions(e,t){return e.y+e.height<=t.y&&e.y+e.height+e.speedY>=t.y&&e.x+e.width>=t.x&&e.x<=t.x+t.width}enemyKillCollistions(e,t){return e.y+e.height-10<=t.y&&e.y+e.height+e.speedY>=t.y&&e.x+e.width>=t.x&&e.x<=t.x+t.width}};let f=0;!function e(t){const s=t-f;f=t,w.update(s),w.draw(),requestAnimationFrame(e)}(0);
//# sourceMappingURL=index.8be78e1a.js.map
